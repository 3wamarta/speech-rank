package com.github.peggybrown.speechrank;import static com.github.peggybrown.speechrank.ConferencesProvider.getConference;import static com.github.peggybrown.speechrank.ConferencesProvider.getConferences;import javaslang.collection.List;import ratpack.server.RatpackServer;public class Main {    private static Storage storage;    public static void main(String... args) throws Exception {        addFakeConference();        RatpackServer.start(server -> server                .handlers(chain -> chain                        .all(new CORSHandler())                        .post("rating", ctx ->                                ctx.parse(Rate.class).then(rate -> {                                    storage.add(rate);                                    ctx.render("OK");                                }))                        .post("comment", ctx ->                                ctx.parse(Comment.class).then(comment -> {                                    storage.add(comment);                                    ctx.render("OK");                                }))                        .get("conferences", ctx -> ctx.render(getConferences()))                        .get(ctx -> ctx.render(options))                        .get("conference/:name", ctx -> {                            ctx.render(getConference(ctx.getPathTokens().get("name")));                        })));    }    private static void addFakeConference() {        storage = new Storage();        Presentation prez = new Presentation("1", "title", "yt.com/sds",0.0, List.empty(), List.empty());        Conference conf = new Conference("11", "Geecon", List.of(prez));        storage.add(conf);    }    private static String options =            "GET /conferences\n" +            "GET /conference/:id\n" +            "POST /rating\n" +            "POST /comment\n";}
